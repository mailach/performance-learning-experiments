name: pim-pipeline

docker_env:
  image: mailach/pim-pipeline:latest
  environment: ["MLFLOW_TRACKING_USERNAME", "MLFLOW_TRACKING_PASSWORD"]
entry_points:
  systems:
    parameters:
      param_file: run.yaml
    command: "python load_system.py --param_file={param_file}"

  sampling:
    parameters:
      system_run_id: system_run_id
      n: n
      binary_method: binary_method
      numeric_method: numeric_method
      true_random: true_random
    command: "python sampling.py --system_run_id={system_run_id} --n={n} --binary_method={binary_method} --numeric_method={numeric_method} --true_random={true_random}"

  learning:
    parameters:
      sampling_run_id: sampling_run_id
      method: method
      nfp: nfp
      min_samples_split: { type: int, default: 2 }
      min_samples_leaf: { type: ing, default: 1 }
    command: "python learning.py --sampling_run_id={sampling_run_id} --method={method} --nfp={nfp} "

  evaluation:
    parameters:
      workflow_id: workflow_id
    command: "python evaluation.py --workflow_id={workflow_id}"

  main:
    parameters:
      param_file: { type: str, default: run.yaml }
    command: "python main.py --param_file={param_file}"
